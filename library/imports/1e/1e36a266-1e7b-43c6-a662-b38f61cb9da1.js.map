{"version":3,"sources":["assets/script/framework/i18n/i18nMgr.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { Log } from \"../../utils/Log\";\nimport * as i18nLabel from \"./i18nLabel\";\nimport * as i18nSprite from \"./i18nSprite\";\n\nexport class i18nMgr {\n    private static labelArr: i18nLabel.i18nLabel[] = [];        // i18nLabel 列表\n    private static labelData: { [key: string]: string } = {};   // 文字配置\n    private static spriteArr: i18nSprite.i18nSprite[] = [];       // i18nSprite 列表\n    private static language: string = \"\"\n\n    public static getlanguage(){\n        return cc.sys.localStorage.getItem(\"language\") || \"zh\"\n    }\n\n    private static checkInit() {\n        if (!this.language) {\n            var _language = cc.sys.localStorage.getItem(\"language\") || \"zh\";\n            this.setLanguage(_language);\n        }\n    }\n\n    /**\n     * 设置语言\n     */\n    public static setLanguage(language: string) {\n        if (this.language === language) {\n            return;\n        }\n        this.language = language;\n        cc.sys.localStorage.setItem(\"language\", language);\n        this.reloadLabel();\n        this.reloadSprite();\n    }\n\n    /**\n     * 添加或移除 i18nLabel\n     */\n    public static _addOrDelLabel(label: i18nLabel.i18nLabel, isAdd: boolean) {\n        if (isAdd) {\n            this.labelArr.push(label);\n        } else {\n            let index = this.labelArr.indexOf(label);\n            if (index !== -1) {\n                this.labelArr.splice(index, 1);\n            }\n        }\n    }\n\n    public static _getLabel(opt: any, params: string[]): string {\n        this.checkInit();\n        if (params.length === 0) {\n            return this.labelData[opt] || opt;\n        }\n\n        let str = this.labelData[opt] || opt;\n        if (typeof str === 'number') {\n            str = str.toString();\n        }\n        \n        for (let i = 0; i < params.length; i++) {\n            let reg = new RegExp(\"#\" + i, \"g\")\n            str = str.replace(reg, params[i]);\n        }\n        return str;\n    }\n\n\n    /**\n     * 添加或移除 i18nSprite\n     */\n    public static _addOrDelSprite(sprite: i18nSprite.i18nSprite, isAdd: boolean) {\n        if (isAdd) {\n            this.spriteArr.push(sprite);\n        } else {\n            let index = this.spriteArr.indexOf(sprite);\n            if (index !== -1) {\n                this.spriteArr.splice(index, 1);\n            }\n        }\n    }\n\n    public static _getSprite(path: string, cb: (spriteFrame: cc.SpriteFrame) => void) {\n        this.checkInit();\n        cc.loader.loadRes(\"i18n/sprite/\" + this.language + \"/\" + path, cc.SpriteFrame, (err, spriteFrame: cc.SpriteFrame) => {\n            if (err) {\n                return cb(null);\n            }\n            cb(spriteFrame);\n        });\n    }\n\n\n    private static reloadLabel() {\n        let url = \"i18n/label/\" + this.language;\n        cc.loader.loadRes(url, (err, data: cc.JsonAsset) => {\n            if (err) {\n                Log.error(err);\n                this.labelData = {};\n            } else {\n                this.labelData = data.json;\n            }\n            for (let one of this.labelArr) {\n                one._resetValue();\n            }\n        });\n    }\n\n    private static reloadSprite() {\n        for (let one of this.spriteArr) {\n            one._resetValue();\n        }\n    }\n\n}\n"]}