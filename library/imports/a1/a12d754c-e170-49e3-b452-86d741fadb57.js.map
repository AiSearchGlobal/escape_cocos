{"version":3,"sources":["assets/script/logic/ui/prefab/UIPlayer.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import auto_player from \"../../../data/autoui/prefab/auto_player\";\nimport UIBase from \"../../../framework/ui/UIBase\";\nimport UIHelp from \"../../../framework/ui/UIHelp\";\n\nconst { ccclass, menu, property } = cc._decorator;\n\n@ccclass\n@menu(\"UI/prefab/UIPlayer\")\nexport default class UIPlayer extends UIBase {\n\tui: auto_player = null;\n\n\tprotected static prefabUrl = \"player\";\n\tprotected static className = \"UIPlayer\";\n\n\tpublic static instance: UIPlayer = null;\n\n\t@property({ type: cc.SpriteAtlas })\n\tplayerAtlas: cc.SpriteAtlas = null;\n\n\t@property({ type: [cc.Sprite] })\n\ticonsSpr: cc.Sprite[] = [];\n\tprivate speed: number = 200;\n\tprivate speed1: number = 200;\n\tprivate speed2: number = 300;\n\tprivate animation: cc.Animation;\n\tprivate isMoving: boolean = false;\n\tprivate bettingCoin: number = 0;\n\n\tonUILoad() {\n\t\tthis.ui = this.node.addComponent(auto_player);\n\t\tUIPlayer.instance = this;\n\t}\n\n\tonShow() {\n\t\tthis.bettingCoin = 0;\n\t}\n\n\tonHide() {\n\n\t}\n\n\tonStart() {\n\t}\n\n\tinitAni(rankNo: number) {\n\n\t\tthis.ui = this.node.addComponent(auto_player);\n\t\tUIPlayer.instance = this;\n\t\tthis.animation = this.ui.img_cat.getComponent(cc.Animation);\n\t\t(window as any).GetGameInfo()\n\t\t\t.then(res => {\n\t\t\t\tconsole.log(res, '获取游戏信息成功')\n\t\t\t\tif (res.code == 0) {\n\t\t\t\t\t(window as any).currencyIcon = res.data.icon;\n\t\t\t\t\t(window as any).currencyName = res.data.coin;\n\n\t\t\t\t\tcc.assetManager.loadRemote((window as any).currencyIcon, (err, texture) => {\n\t\t\t\t\t\tif (err) {\n\t\t\t\t\t\t\tconsole.log(err)\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconsole.log(texture, 'texture')\n\t\t\t\t\t\tconst spriteFrame = new cc.SpriteFrame(texture as cc.Texture2D);\n\t\t\t\t\t\tspriteFrame.addRef();\n\t\t\t\t\t\tthis.iconsSpr.forEach(item => {\n\t\t\t\t\t\t\titem.spriteFrame = spriteFrame;\n\t\t\t\t\t\t})\n\t\t\t\t\t});\n\n\t\t\t\t}\n\n\t\t\t})\n\t\t\t.catch(err => {\n\t\t\t\tconsole.log(err, '获取游戏信息失败')\n\t\t\t})\n\t}\n\n\t/**\n\t * 创建动画帧\n\t * @param {*} name 动画名字\n\t * @param {*} WrapMode 动画循环模式（单次循环）\n\t */\n\tcreatorAnimation(picName: string, length: number, name: string, WrapMode = cc.WrapMode.Loop) {\n\t\tlet showTip = [];\n\t\tfor (let i = 0; i <= length; i++) {\n\t\t\t//获取动画集合下的第一个动画plist文件，并以动画名称依次播放\n\t\t\tlet frame = this.playerAtlas.getSpriteFrame(`${picName}_${i}`);\n\t\t\tif (frame) {\n\t\t\t\tshowTip.push(frame); //添加动画帧到数组\n\t\t\t}\n\t\t}\n\t\t//创建一组动画剪辑\n\t\tlet clip = cc.AnimationClip.createWithSpriteFrames(showTip, showTip.length);\n\t\tclip.wrapMode = WrapMode;//设置播放模式\n\t\tclip.name = name;//设置名字\n\t\tthis.animation.addClip(clip);//添加动画帧到动画组件中\n\t}\n\n\tshowBetting(bettingCoin: number) {\n\t\tthis.bettingCoin = bettingCoin;\n\t\tif (this.isMoving) {\n\t\t\treturn\n\t\t}\n\n\t\tthis.ui.img_bubble.active = bettingCoin > 0;\n\t\tUIHelp.SetLabel(this.ui.lab_coin, bettingCoin);\n\t}\n\n\thideBetting() {\n\t\tthis.ui.img_bubble.active = false;\n\t}\n\n\tplayWalk() {\n\t\tthis.isMoving = true;\n\t\tthis.animation.play(\"walk\");\n\t\tthis.hideBetting();\n\t}\n\n\tplayWait() {\n\t\tthis.isMoving = false;\n\t\tthis.animation.play(\"wait\");\n\t\tthis.showBetting(this.bettingCoin);\n\t}\n\n\tflashToRoomById(pos: any) {\n\t\tthis.node.stopAllActions();\n\t\tthis.node.setPosition(pos);\n\t}\n\n\tmove(list: any[], isBack: boolean) {\n\t\tif (list.length <= 0) {\n\t\t\tif (isBack) {\n\t\t\t\tthis.bettingCoin = 0;\n\t\t\t}\n\t\t\tthis.playWait();\n\t\t\treturn\n\t\t}\n\n\t\tthis.speed = isBack ? this.speed2 : this.speed1;\n\t\tthis.ui.img_cat.scaleX = this.node.x > list[0].x ? -1 : 1;\n\t\tvar dis = this.getDistance(this.node.position, list[0]);\n\t\tvar t = dis / this.speed;\n\t\tcc.tween(this.node)\n\t\t\t.to(t, { position: list[0] })\n\t\t\t.call(() => {\n\t\t\t\tlist.splice(0, 1);\n\t\t\t\tthis.move(list, isBack);\n\t\t\t})\n\t\t\t.start();\n\t}\n\n\t// 距离\n\tgetDistance(start, end) {\n\t\tvar pos = cc.v2(start.x - end.x, start.y - end.y);\n\t\tvar dis = Math.sqrt(pos.x * pos.x + pos.y * pos.y);\n\t\treturn dis;\n\t}\n\n\tonClose() {\n\t\tUIHelp.CloseUI(UIPlayer);\n\t}\n}\n"]}