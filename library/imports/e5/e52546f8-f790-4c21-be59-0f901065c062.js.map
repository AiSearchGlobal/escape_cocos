{"version":3,"sources":["assets/script/framework/behavior/BhvSwitchPage.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["\nconst { ccclass, property, executeInEditMode,menu} = cc._decorator;\n\n\n@ccclass\n@executeInEditMode\n@menu(\"添加特殊行为/UI/Switch Page (切换页面)\")\nexport default class BhvSwitchPage extends cc.Component {\n\n    @property\n    isLoopPage: boolean = false;\n\n    @property\n    private _index: number = 0;\n    public get index(): number {\n        return this._index;\n    }\n    @property({\n        type: cc.Integer\n    })\n    public set index(v: number) {\n        if (this.isChanging) return;\n        v = Math.round(v);\n        let count = this.node.childrenCount - 1;\n        if (this.isLoopPage) {\n            if (v > count) v = 0;\n            if (v < 0) v = count;\n        } else {\n            if (v > count) v = count;\n            if (v < 0) v = 0;\n        }\n        this.preIndex = this._index;//标记之前的页面\n        this._index = v;\n        if (CC_EDITOR) {\n            this._updateEditorPage(v);\n        } else {\n            this._updatePage(v);\n        }\n    }\n\n    private preIndex: number = 0;\n\n    //判断是否在 changing 页面状态\n\n    private _isChanging: boolean = false;\n    /**只读，是否在changing 的状态 */\n    public get isChanging(): boolean {\n        return this._isChanging;\n    }\n\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad() {\n        this.preIndex = this.index;\n    }\n\n    private _updateEditorPage(page: number) {\n        if (!CC_EDITOR) return;\n        let children = this.node.children;\n        for (let i = 0; i < children.length; i++) {\n            const node = children[i];\n            if (i == page) {\n                node.active = true;\n            } else {\n                node.active = false;\n            }\n\n\n        }\n    }\n\n    private _updatePage(page: number){\n        let children = this.node.children;\n        let preIndex = this.preIndex;\n        let curIndex = this.index;\n        if (preIndex === curIndex) return;//没有改变就不进行操作\n\n        let preNode: cc.Node = children[preIndex];//旧节点\n        let showNode: cc.Node = children[curIndex];//新节点\n\n        preNode.active = false;\n        showNode.active = true;\n\n    }\n\n    public next(): boolean {\n        if (this.isChanging) {\n            return false;\n        } else {\n            this.index++;\n            return true;\n        }\n\n    }\n\n    public previous(): boolean {\n        if (this.isChanging) {\n            return false;\n        } else {\n            this.index--;\n            return true;\n        }\n    }\n\n    public setEventIndex(e, index): boolean {\n        if (this.index >= 0 && this.index != null && this.isChanging === false) {\n            this.index = index;\n            return true;\n        } else {\n            return false;\n        }\n    }\n\n}\n"]}