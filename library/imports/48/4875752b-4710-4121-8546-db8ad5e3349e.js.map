{"version":3,"sources":["assets/script/framework/adapter/abstract/Group.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { Layer, StretchDirection, WrapMode } from \"../define/enum\";\nimport { IModel, ILike } from \"../define/interface\";\nimport { ScrollAdapter } from \"./ScrollAdapter\";\nimport { View } from \"./View\";\nexport class Group<T, A extends ScrollAdapter<T> = ScrollAdapter<T>>{\n    private _adapter: A\n    public get adapter() { return this._adapter }\n    private _index: number = -1\n    public get index() { return this._index }\n    private _models: IModel<T>[] = []\n    public get models() { return this._models }\n    private _size: ILike = { x: 0, y: 0 }\n    public get size() { return this._size }\n    private _oldSize: ILike = { x: 0, y: 0 }\n    public get oldSize() { return this._oldSize }\n    private _anchorPoint: ILike = { x: 0.5, y: 0.5 }\n    public get anchorPoint() { return this._anchorPoint }\n    private _position: ILike = { x: 0, y: 0 }\n    public get position() { return this._position }\n    private _oldPosition: ILike = { x: 0, y: 0 }\n    public get oldPosition() { return this._oldPosition }\n    private _totalMinSize: ILike = { x: 0, y: 0 }\n    public get totalMinSize() { return this._totalMinSize }\n    private _totalPreferredSize: ILike = { x: 0, y: 0 }\n    public get totalPreferredSize() { return this._totalPreferredSize }\n    private _totalFlexibleSize: ILike = { x: 0, y: 0 }\n    public get totalFlexibleSize() { return this._totalFlexibleSize }\n    private _isFixed: boolean = false\n    public get isFixed() { return this._isFixed }\n    private _fixedIndex: number = -1\n    public get fixedIndex() { return this._fixedIndex }\n    constructor(adapter: A) {\n        this._adapter = adapter\n        this.internal_reset()\n    }\n    public findModelIndex(modelIndex: number) {\n        return this.models.findIndex(item => item.index == modelIndex)\n    }\n    /** @deprecated 内部方法，调用会爆炸💥 */\n    public internal_reset() {\n        this._models = []\n        this._size = { x: 0, y: 0 }\n        this._oldSize = { x: 0, y: 0 }\n        this._anchorPoint = { x: 0.5, y: 0.5 }\n        this._position = { x: 0, y: 0 }\n        this._oldPosition = { x: 0, y: 0 }\n        this._totalMinSize = { x: 0, y: 0 }\n        this._totalPreferredSize = { x: 0, y: 0 }\n        this._totalFlexibleSize = { x: 0, y: 0 }\n        this._isFixed = false\n        this._fixedIndex = -1\n        this._setAnchorPoint()\n    }\n\n    /** @deprecated 内部方法，调用会爆炸💥 */\n    public internal_setPosition(position: number) {\n        var mainAxis = this.adapter.mainAxis\n        this.oldPosition[mainAxis] = this.position[mainAxis]\n        this.position[mainAxis] = position\n    }\n    /** @deprecated 内部方法，调用会爆炸💥 */\n    public internal_setIndex(index: number) {\n        this._index = index\n    }\n    /** @deprecated 内部方法，调用会爆炸💥 */\n    public internal_insert(options: { modelIndex: number, fixedIndex: number }, view: View, clear: boolean) {\n        view.internal_reset()\n        var caches = this.models\n        this.internal_reset()\n        this._fixedIndex = options.fixedIndex\n        if (!clear) {\n            for (let i = 0; i < caches.length; i++) {\n                const model = caches[i];\n                if (model.index < options.modelIndex) {\n                    let ok = this._insertHandler(model, view)\n                    if (!ok) {\n                        options.modelIndex = model.index\n                        options.fixedIndex = this.isFixed ? this.index : options.fixedIndex\n                        return true\n                    }\n                } else {\n                    break\n                }\n            }\n        }\n        for (let i = options.modelIndex; i < this.adapter.modelManager.length; i++) {\n            const model = this.adapter.modelManager.get(i)\n            let ok = this._insertHandler(model, view)\n            if (!ok) {\n                options.modelIndex = model.index\n                options.fixedIndex = this.isFixed ? this.index : options.fixedIndex\n                return model.index\n            }\n        }\n        return false\n    }\n    /** @deprecated 内部方法，调用会爆炸💥 */\n    public internal_includes(dataList: T[]) {\n        for (let i = 0; i < dataList.length; i++) {\n            const data = dataList[i];\n            var index = this.models.findIndex(item => item.data == data)\n            if (-1 != index) return true\n        }\n        return false\n    }\n    private _insertHandler(model: IModel<T>, view: View) {\n        var wrap = view.internal_isWrap(model, this)\n        if (wrap) {\n            view.internal_reset()\n            return false\n        }\n        view.internal_push(model)\n        if (model.element.fixed) {\n            this._isFixed = true\n            this._fixedIndex = -1\n        }\n        var mainAxis = this.adapter.mainAxis\n        var crossAxis = this.adapter.crossAxis\n        if (!model.element.ignoreLayout || model.element.ignoreLayout && model.element.placeholder) {\n            this.size[mainAxis] = Math.max(this.size[mainAxis], model.size[mainAxis] * model.scale[mainAxis])\n        }\n        this.size[crossAxis] = this.adapter.crossAxisSize\n        this.oldSize[mainAxis] = this.size[mainAxis]\n        this.oldSize[crossAxis] = this.size[crossAxis]\n        this.models.push(model)\n        return true\n    }\n    private _setAnchorPoint() {\n        switch (this.adapter.viewManager.stretchDirection) {\n            case StretchDirection.Center:\n                this.anchorPoint[this.adapter.mainAxis] = 0.5\n                break\n            case StretchDirection.Header:\n                this.anchorPoint[this.adapter.mainAxis] = 1 - this.adapter.mainAxisAnchorPoint\n                break\n            default:\n                this.anchorPoint[this.adapter.mainAxis] = this.adapter.mainAxisAnchorPoint\n                break\n        }\n    }\n}"]}