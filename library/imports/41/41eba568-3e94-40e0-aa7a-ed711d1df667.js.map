{"version":3,"sources":["assets/script/framework/i18n/i18nLabel.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { i18nMgr } from \"./i18nMgr\";\nconst { ccclass, property, executeInEditMode, disallowMultiple, menu } =\n  cc._decorator;\nexport function replaceMatchingCharacters(inputStr: string, pattern: string | RegExp, replacement: string): string {\n  // 如果pattern不是正则表达式，则转换为正则表达式\n  let regexPattern: RegExp;\n  if (typeof pattern === 'string') {\n    // 转义特殊字符以确保安全地创建正则表达式\n    const escapedPattern = pattern.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n    regexPattern = new RegExp(escapedPattern, 'g');\n  } else {\n    regexPattern = pattern;\n  }\n\n  // 使用replace方法进行替换\n  return inputStr.replace(regexPattern, replacement);\n}\n@ccclass\n@executeInEditMode\n@disallowMultiple\n@menu(\"多语言/i18nLabel\")\nexport class i18nLabel extends cc.Label {\n  @property({ type: cc.String })\n  get i18n_key() {\n    return this.i18n_string;\n  }\n\n  set i18n_key(value: string) {\n    this.i18n_string = value;\n\n    this.setEndValue();\n  }\n\n  @property({ type: [cc.String] })\n  get params() {\n    return this.i18n_params;\n  }\n\n  set params(value: string[]) {\n    this.i18n_params = value;\n\n    this.setEndValue();\n  }\n\n  @property({ visible: false })\n  private i18n_string: string = \"\";\n\n  @property({ visible: false })\n  private i18n_params: string[] = [];\n\n  start() {\n    i18nMgr._addOrDelLabel(this, true);\n    this._resetValue();\n  }\n\n  init(...params: any[]) {\n    if (this.params.length == 0) {\n      this.i18n_string = String(params[0]);\n    } else if (params.length >= 1) {\n      this.i18n_params = params;\n    }\n\n    this.setEndValue();\n  }\n\n  private setEndValue() {\n    if (this.i18n_string) {\n      let str = i18nMgr._getLabel(this.i18n_string, this.i18n_params);\n      this.string = replaceMatchingCharacters(str, 'GSP', (window as any).currencyName);\n    }\n  }\n\n\n  _resetValue() {\n    this.i18n_key = this.i18n_string;\n  }\n\n  onDestroy() {\n    i18nMgr._addOrDelLabel(this, false);\n  }\n}\n"]}