{"version":3,"sources":["assets/script/logic/ui/prefab/JiluAdapter.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { Holder } from \"../../../framework/adapter/abstract/Holder\";\nimport { ScrollAdapter } from \"../../../framework/adapter/abstract/ScrollAdapter\";\nimport { View } from \"../../../framework/adapter/abstract/View\";\nimport { ReleaseState } from \"../../../framework/adapter/define/enum\";\nimport { IElement } from \"../../../framework/adapter/define/interface\";\nimport { ReleaseEvent, ReleaseManager } from \"../../../framework/adapter/manager/ReleaseManager\";\nimport GameDataCenter from \"../../../userData/GameDataCenter\";\nimport UIJiluItem1 from \"./UIJiluItem1\";\nimport UIJiluItem2 from \"./UIJiluItem2\";\nimport UIJiluItem3 from \"./UIJiluItem3\";\nimport UIJiluItem4 from \"./UIJiluItem4\";\nimport UIJiluItem5 from \"./UIJiluItem5\";\n\nconst { ccclass, menu, property } = cc._decorator;\nexport interface IChatModel {\n    type: number\n    name: string\n    message: string\n}\n@ccclass\n@menu(\"UI/prefab/JiluAdapter\")\nexport class JiluAdapter extends ScrollAdapter<IChatModel> {\n    @property(cc.Prefab) prefab1: cc.Prefab = null\n    @property(cc.Prefab) prefab2: cc.Prefab = null\n    @property(cc.Prefab) prefab3: cc.Prefab = null\n    @property(cc.Prefab) prefab4: cc.Prefab = null\n    @property(cc.Prefab) prefab5: cc.Prefab = null\n    @property(cc.Node) header: cc.Node = null\n    @property(cc.Node) loading: cc.Node = null\n    private _headerTween: cc.Tween<any>\n    private _loadTween: cc.Tween<any>\n    private _isHeaderPlay = false\n    private page: number = 1;\n    public getPrefab(data: IChatModel): cc.Prefab {\n        if(data.type == 1){\n            return this.prefab1;\n        }else if(data.type == 2){\n            return this.prefab2;\n        }else if(data.type == 3){\n            return this.prefab3;\n        }else if(data.type == 4){\n            return this.prefab4;\n        }else{\n            return this.prefab5;\n        }\n    }\n    public getHolder(node: cc.Node, code: string): Holder<IChatModel> {\n        return new myHolder(node, code, this)\n    }\n    public getView(): View<IChatModel> {\n        return new myView(this)\n    }\n    public initElement(element: IElement, data: any): void {\n    }\n\n    async start() {\n        this.releaseManager.on(ReleaseManager.Event.ON_PULL_UP, this.onPullDown, this);\n\n        this._headerTween = new cc.Tween(this.header).to(0.518, {\n            height: this.releaseManager.bottom * this.mainAxisSize\n        }, { easing: \"elasticOut\" });\n\n        this._loadTween = new cc.Tween(this.loading).by(1, {\n            angle: -360\n        }).union().repeatForever();\n\n        GameDataCenter.accountModel.noMoreJilu = false;\n        var list1 = await GameDataCenter.accountModel.getGameLog();\n        this.modelManager.insert(list1);\n        var list2 = await GameDataCenter.accountModel.getBettingLog(1);\n        this.modelManager.insert(list2);\n    }\n\n    async onPullDown(event: ReleaseEvent) {\n        if (event.state == ReleaseState.RELEASE) {\n            if (this._isHeaderPlay) {\n                this._loadTween.start()\n                // 等待并锁定头部\n                event.wait()\n                // 加载历史记录\n                this.page += 1;\n                var list = await GameDataCenter.accountModel.getBettingLog(this.page);\n                // 插入数据\n                this.modelManager.insert(list)\n                // 释放解锁头部\n                this.scheduleOnce(() => {\n                    event.release()\n                })\n                this._loadTween.stop()\n            }\n        }\n        var progress = event.progress\n        if (event.state == ReleaseState.WAIT) {\n            progress = 0.1\n        }\n        if (progress >= 0.1) {\n            if (!this._isHeaderPlay) {\n                // this._headerTween = new cc.Tween(this.header).to(0.518, {\n                //     height: this.releaseManager.bottom * this.mainAxisSize\n                // }, { easing: \"elasticOut\" })\n                this._headerTween.start()\n                this._isHeaderPlay = true\n            }\n        } else {\n            this._headerTween.stop()\n            this._isHeaderPlay = false\n            // this.header.height = event.offset\n            // var opacity = 255 * Math.min(progress, 1)\n            // this.loading.opacity = opacity;\n            this.loading.opacity = 0;\n        }\n        this.loading.angle = -360 * event.progress\n    }\n\n    scrollToHeader() {\n        this.scrollManager.scrollToHeader(1)\n    }\n}\n\nclass myView extends View<IChatModel, JiluAdapter> {\n\n    protected onVisible(): void {\n    }\n    protected onDisable(): void {\n    }\n}\nclass myHolder extends Holder<IChatModel, JiluAdapter>{\n    private _chatItem: UIJiluItem5 | UIJiluItem4 | UIJiluItem3 | UIJiluItem2 | UIJiluItem1 = null\n    protected onCreated(): void {\n        this._chatItem = this.node.getComponent(UIJiluItem5) || this.node.getComponent(UIJiluItem4) || this.node.getComponent(UIJiluItem3) || this.node.getComponent(UIJiluItem2) || this.node.getComponent(UIJiluItem1)\n    }\n    protected onVisible(): void {\n        this._chatItem.show(this)\n    }\n    protected onDisable(): void {\n        this._chatItem.hide()\n    }\n\n}\n\n"]}