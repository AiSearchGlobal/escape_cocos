{"version":3,"sources":["assets/script/userData/RoomInfoModel.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { replaceMatchingCharacters } from \"../framework/i18n/i18nLabel\";\nimport { i18nMgr } from \"../framework/i18n/i18nMgr\";\nimport EventMng from \"../framework/manager/EventMng\";\nimport IDataModel from \"../framework/model/IDataModel\";\nimport { GameEvent } from \"./EventConst\";\nimport GameDataCenter from \"./GameDataCenter\";\nexport var ROAD_NAME = {\n    1: { zh: \"雜物間\", en: 'Utility room' },\n    2: { zh: \"休息室\", en: 'Rest room' },\n    3: { zh: \"廠長室\", en: 'Director room' },\n    4: { zh: \"談話室\", en: 'Conversation room' },\n    5: { zh: \"洗衣室\", en: 'Laundry room' },\n    6: { zh: \"工作室\", en: 'studio room' },\n    7: { zh: \"茶水間\", en: 'Tea room' },\n    8: { zh: \"音樂室\", en: 'Music room' },\n}\nexport var ROOM_NAME = {\n    1: { zh: \"GSP\", en: 'GSP' },\n    2: { zh: \"GSP\", en: 'GSP' },\n    3: { zh: \"GSP\", en: 'GSP' },\n}\nexport default class RoomInfoModel extends IDataModel {\n    public gameStage: number = 1;       //游戏状态\n    public roomType: number = 1;        //房间类型\n    public waitTime: number = 0;        //状态等待时间\n    public coin: number = 0;            //拥有的coin\n    public coin1: number = 0;           //房间1所有玩家下注的coin\n    public coin2: number = 0;\n    public coin3: number = 0;\n    public coin4: number = 0;\n    public coin5: number = 0;\n    public coin6: number = 0;\n    public coin7: number = 0;\n    public coin8: number = 0;\n    public coinName: string = \"金币\";\n    public bettingConfig1: number = 0;\n    public bettingConfig2: number = 0;\n    public bettingConfig3: number = 0;\n    public bettingNum: number = 0;\n    public bettingId: number = 1;           //下注id：1-3\n    public roomId: number = 0;              //房间id：1-8\n    public minPlayerNum: number = 0;        //等待状态当前人数\n    public maxPlayerNum: number = 0;        //等待状态所需最大人数\n    // public killRoomName: string = \"工具房\";  //被杀房间名字\n    public killRoomId: number = undefined;\n    public coinGuafenNum: number = 0;       //所有人瓜分的coin数量\n    public resultType: number = 0;          //游戏结束显示的类型\n    public gameNo: number = 0;              //当前期数\n    public lastShaRoomId: number = undefined\n    // public lastShaRoomName: string = \"\";    //上期被杀房间名字\n    public bettingCoin: number = 0;         //下注coin数量\n    public winCoin: number = 0;             //获得coin数量\n\n    public get killRoomName() {\n        if (ROAD_NAME[this.killRoomId]) {\n            return ROAD_NAME[this.killRoomId][i18nMgr.getlanguage()]\n        }\n\n        return ''\n    }\n\n    public get lastShaRoomName() {\n        if (ROAD_NAME[this.lastShaRoomId]) {\n            return ROAD_NAME[this.lastShaRoomId][i18nMgr.getlanguage()]\n        }\n        return ''\n    }\n\n    constructor() {\n        super('roomInfo');\n    }\n\n    initData(res: any) {\n        this.roomType = res.room_type;\n        this.minPlayerNum = res.betting_num;\n        this.maxPlayerNum = res.total_num;\n        this.gameNo = res.game_no;\n        // this.lastShaRoomName = ROAD_NAME[res.last_shaid][i18nMgr.getlanguage()] || \"\";\n        this.lastShaRoomId = res.last_shaid\n        this.changeRoomStage(res);\n        this.setRoomName(res.room_type);\n    }\n\n    /** 改变房间状态\n     * 阶段1 等待阶段 满人即开局\n     * 阶段2 等待杀手阶段\n     * 阶段3 杀手准备出现阶段\n     * 阶段4 杀手出现阶段\n     * 阶段5 游戏结果阶段\n     */\n    changeRoomStage(res: any) {\n        this.gameStage = res.game_stage;\n        this.waitTime = res.wait_time;\n        console.warn(\"game_stage:  \", this.gameStage);\n    }\n\n    /** 初始化金币/钻石消耗数量 */\n    initBettingConf(res: any) {\n        this.bettingConfig1 = this.bettingNum = res[0]?.coin || 0.2;\n        this.bettingConfig2 = res[1]?.coin || 0.2;\n        this.bettingConfig3 = res[2]?.coin || 0.2;\n        this.bettingId = 1;\n    }\n\n    /** vm刷新房间下注的金币/钻石 */\n    initRoomsCoin(rooms: { roomid: number, total: number }[], isScale: boolean) {\n        if (isScale) {\n            EventMng.emit(GameEvent.COIN_SCALE, rooms);\n        }\n\n        for (let index of rooms) {\n            this[`coin${index.roomid}`] = index.total;\n        }\n    }\n\n    setCoin(user: any) {\n        if (user.uid == GameDataCenter.accountModel.uid) {\n            this.coin = user.coin;\n        }\n    }\n\n    setKillResult(data: any) {\n        // const language = i18nMgr.getlanguage()\n        // this.killRoomName = ROAD_NAME[data.shaid][language];\n        // this.lastShaRoomName = ROAD_NAME[data.shaid][language];\n        this.lastShaRoomId = data.shaid\n        this.killRoomId = data.shaid\n        this.coinGuafenNum = data.sha_total;\n        this.bettingCoin = data.betting_coin;\n        this.winCoin = data.win_coin;\n        if (data.tp == \"over\") {\n            //没下注\n            if (this.roomId == 0) {\n                //没进房间\n                this.resultType = 2;\n            } else if (this.roomId == data.shaid) {\n                //输\n                this.resultType = 1;\n            } else {\n                //赢\n                this.resultType = 3;\n            }\n        } else if (data.tp == \"win\") {\n            //已下注，赢\n            this.resultType = 4;\n        } else if (data.tp == \"lose\") {\n            //已下注，输\n            this.resultType = 1;\n        }\n    }\n\n    /** 设置房间名 */\n    private setRoomName(id: number) {\n        this.coinName = replaceMatchingCharacters(ROOM_NAME[id][i18nMgr.getlanguage()], 'GSP', (window as any).currencyName);\n    }\n}"]}