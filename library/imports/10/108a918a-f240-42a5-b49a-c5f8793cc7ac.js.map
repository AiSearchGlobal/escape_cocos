{"version":3,"sources":["assets/script/userData/PlayerModel.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { i18nMgr } from \"../framework/i18n/i18nMgr\";\nimport { PoolMng } from \"../framework/manager/PoolMng\";\nimport IDataModel from \"../framework/model/IDataModel\";\nimport UIHelp from \"../framework/ui/UIHelp\";\nimport UIGameLayer from \"../logic/ui/prefab/UIGameLayer\";\nimport UIPlayer from \"../logic/ui/prefab/UIPlayer\";\nimport UIPlayerName from \"../logic/ui/prefab/UIPlayerName\";\nimport GameDataCenter from \"./GameDataCenter\";\nexport var ROADS = {\n    1: [1, 3, 4, 1111],\n    2: [1, 3, 9, 2222],\n    3: [1, 3, 3333],\n    4: [1, 3, 4, 4444],\n    5: [1, 2, 5, 5555],\n    6: [1, 2, 6666],\n    7: [1, 2, 6, 7777],\n    8: [1, 2, 7, 8888],\n}\n\nexport var KILLER_ROADS = {\n    1: [12, 11, 3, 4],\n    2: [12, 11, 3, 9],\n    3: [12, 11, 2, 3],\n    4: [12, 11, 3, 4],\n    5: [12, 11, 2, 5],\n    6: [12, 11, 10, 2],\n    7: [12, 11, 2, 6],\n    8: [12, 11, 2, 7],\n}\nexport default class PlayerModel extends IDataModel {\n    public avatar: string = \"\";\n    public coin: number = 0;\n    public nickname: string = \"\";\n    public uid: number = 0;\n    public node: cc.Node = null;\n    public nodeName: cc.Node = null;\n    public roomId: number = 0;\n    public rankNo: number = 0;\n    public isMySelf: boolean = false;\n\n    constructor() {\n        super('player');\n    }\n\n    destroy(){\n        if(this.node){\n            this.node.stopAllActions();\n            PoolMng.instance.putNode(this.node);\n            this.nodeName.stopAllActions();\n            PoolMng.instance.putNode(this.nodeName);\n        }\n        GameDataCenter.accountModel.players.delete(this.uid);\n    }\n\n    initData(res){\n        const language = {\n            zh: '自己',\n            en: 'Myself'\n        }\n\n        this.avatar = res.avatar;\n        this.coin = res.coin;\n        this.isMySelf = res.uid == GameDataCenter.accountModel.uid ? true : false;\n        this.nickname = this.isMySelf ? language[i18nMgr.getlanguage()] : res.nickname;\n        this.uid = res.uid;\n        if(this.isMySelf){\n            if(res.rank_no == 0){\n                this.rankNo = -1;\n            }else{\n                this.rankNo = res.rank_no;\n            }\n        }else{\n            this.rankNo = res.rank_no;\n        }\n    }\n\n    showBetting(bettingCoin: number){\n        if(!this.node){\n            return\n        }\n        this.node.getComponent(UIPlayer)?.showBetting(bettingCoin);\n    }\n\n    /** 加载并显示人物 */\n    loadPlayerAni(roomId: number){\n        this.roomId = roomId;\n\t\tvar nodePlayer = this.node = PoolMng.instance.getNode(UIGameLayer.instance.playerPrefab, this.isMySelf ? UIGameLayer.instance.ui.node_player_my : UIGameLayer.instance.ui.node_player);\n        var nodePlayerName = this.nodeName = PoolMng.instance.getNode(UIGameLayer.instance.playerNamePrefab, this.isMySelf ? UIGameLayer.instance.ui.node_player_name_my : UIGameLayer.instance.ui.node_player_name);\n\t\tvar pos = this.isMySelf ? UIHelp.getRadomPos(UIGameLayer.instance.ui[`room${roomId * 100}`]) : UIHelp.getRadomPos(UIGameLayer.instance.ui[`room${roomId}`]);\n        nodePlayer.setPosition(pos);\n        nodePlayer.getComponent(UIPlayer)?.initAni(this.rankNo);\n        nodePlayerName.setPosition(pos);\n        nodePlayerName.getComponent(UIPlayerName)?.setName(this.nickname);\n\t}\n\n    /** 移动到某一房间 */\n    moveToRoomById(roomId: number){\n        if(!this.node){\n            return\n        }\n        if(this.roomId == 0){\n            this.roomId = roomId;\n\n            var list = [];\n            for(let index of ROADS[roomId]){\n                let node: cc.Node = UIGameLayer.instance.ui[`pos${index}`];\n                list.push(node.position);\n            }\n\n            if(this.isMySelf){\n                list.push(UIHelp.getRadomPos(UIGameLayer.instance.ui[`room${roomId * 100}`]));\n            }else{\n                list.push(UIHelp.getRadomPos(UIGameLayer.instance.ui[`room${roomId}`]));\n            }\n\n            this.node.getComponent(UIPlayer)?.playWalk();\n            this.node.getComponent(UIPlayer)?.move([].concat(list), false);\n            this.nodeName.getComponent(UIPlayerName)?.move([].concat(list), false);\n        }else{\n            this.roomId = roomId;\n            this.node.getComponent(UIPlayer)?.playWait();\n            var pos = UIHelp.getRadomPos(UIGameLayer.instance.ui[`room${roomId * 100}`]);\n            this.node.getComponent(UIPlayer)?.flashToRoomById(pos);\n            this.nodeName.getComponent(UIPlayerName)?.flashToRoomById(pos);\n        }\n    }\n\n    /** 从某一房间回到初始位置 */\n    moveBack(){\n        if(!this.node){\n            return\n        }\n        if(this.roomId == 0){\n\t\t\treturn\n\t\t}\n\n\t\tvar list = [];\n\t\tfor(let index of ROADS[this.roomId]){\n\t\t\tlet node: cc.Node = UIGameLayer.instance.ui[`pos${index}`];\n\t\t\tlist.push(node.position);\n\t\t}\n\t\tlist.reverse();\n\t\tlist.push(UIHelp.getRadomPos(UIGameLayer.instance.ui[`room0`]));\n        this.node.getComponent(UIPlayer)?.playWalk();\n        this.node.getComponent(UIPlayer)?.move([].concat(list), true);\n        this.nodeName.getComponent(UIPlayerName)?.move([].concat(list), true);\n        this.roomId = 0;\n        UIGameLayer.instance.resetRoomId();\n    }\n\n    //同步\n    demoXXX1(): Promise<any> {\n        var params = {\n        }\n\n        return new Promise((resolve, reject) => {\n            this.sendHttpMsg(\"index\", params, function (res) {\n                let data = res.data;\n                resolve(data);\n            }.bind(this))\n        });\n    }\n}"]}