{"version":3,"sources":["assets/script/framework/model/ISerialize.ts"],"names":[],"mappings":";;;;;;AAAA,MAAM;AACN;IAQI,oBAAY,SAAqB;QAArB,0BAAA,EAAA,qBAAqB;QAPvB,cAAS,GAAW,SAAS,CAAC;QAExC;;WAEG;QACK,gBAAW,GAAG,EAAE,CAAC;QAGrB,IAAI,CAAC,SAAS,GAAG,SAAS,CAAC;QAC3B,IAAI,CAAC,WAAW,EAAE,CAAC;IACvB,CAAC;IAED,0BAAK,GAAL;IAEA,CAAC;IAEM,gCAAW,GAAlB;QACI,IAAI,IAAI,GAAG,IAAI,CAAC;QAChB,IAAG,EAAE,CAAC,GAAG,CAAC,QAAQ,IAAI,EAAE,CAAC,GAAG,CAAC,WAAW,EAAC;YACrC,EAAE,CAAC,UAAU,CAAC;gBACV,GAAG,EAAE,WAAS,IAAI,CAAC,SAAW;gBAC9B,OAAO,YAAE,GAAG;oBACV,IAAI,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;oBAEhC,IAAI,CAAC,IAAI,IAAI,IAAI,KAAK,EAAE,EAAE;wBACpB,IAAI,CAAC,WAAW,GAAG,EAAE,CAAA;wBACrB,IAAI,CAAC,IAAI,EAAE,CAAC;qBACf;yBAAM;wBACH,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;qBAC3B;gBACL,CAAC;aACJ,CAAC,CAAA;SACL;aAAI;YACD,IAAI,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,GAAG,CAAC,YAAY,CAAC,OAAO,CAAC,WAAS,IAAI,CAAC,SAAW,CAAC,CAAC,CAAC;YAE9E,IAAI,CAAC,IAAI,IAAI,IAAI,KAAK,EAAE,EAAE;gBACtB,IAAI,CAAC,WAAW,GAAG,EAAE,CAAA;gBACrB,IAAI,CAAC,IAAI,EAAE,CAAC;aACf;iBAAM;gBACH,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;aAC3B;SACJ;IACL,CAAC;IAED;;;;OAIG;IACI,0BAAK,GAAZ,UAAa,IAAY,EAAE,YAAwB;QAAxB,6BAAA,EAAA,mBAAwB;QAC/C,IAAI,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,SAAS,EAAE;YACrC,OAAO,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;SACjC;QACD,OAAO,YAAY,CAAC;IACxB,CAAC;IAED;;;;OAIG;IACI,wBAAG,GAAV,UAAW,IAAY,EAAE,KAAgC;QACrD,IAAI,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,KAAK,EAAE;YAC3D,OAAO,KAAK,CAAC,CAAA,SAAS;SACzB;QACD,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,GAAG,KAAK,CAAC;QAC/B,OAAO,IAAI,CAAC;IAChB,CAAC;IAEM,yBAAI,GAAX;QACI,IAAG,EAAE,CAAC,GAAG,CAAC,QAAQ,IAAI,EAAE,CAAC,GAAG,CAAC,WAAW,EAAC;YACrC,EAAE,CAAC,UAAU,CAAC;gBACV,GAAG,EAAE,WAAS,IAAI,CAAC,SAAW;gBAC9B,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,WAAW,CAAC;aACvC,CAAC,CAAA;SACP;aAAI;YACD,EAAE,CAAC,GAAG,CAAC,YAAY,CAAC,OAAO,CAAC,WAAS,IAAI,CAAC,SAAW,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC;SAC5F;IACL,CAAC;IACL,iBAAC;AAAD,CAhFA,AAgFC,IAAA","file":"","sourceRoot":"/","sourcesContent":["//序列化类\nexport default class ISerialize {\n    protected modelName: string = 'default';\n\n    /**\n     * 本地缓存的数据\n     */\n    private _dLocalData = {};\n\n    constructor(modelName = 'default') {\n        this.modelName = modelName;\n        this.LoadStorage();\n    }\n\n    clear() {\n\n    }\n\n    public LoadStorage() {\n        var self = this;\n        if(cc.sys.platform == cc.sys.WECHAT_GAME){\n            wx.getStorage({\n                key: `model_${this.modelName}`,\n                success (res) {\n                  let data = JSON.parse(res.data);\n\n                  if (!data || data === \"\") {\n                        self._dLocalData = {}\n                        self.Save();\n                    } else {\n                        self._dLocalData = data;\n                    }\n                }\n            })\n        }else{\n            let data = JSON.parse(cc.sys.localStorage.getItem(`model_${this.modelName}`));\n\n            if (!data || data === \"\") {\n                this._dLocalData = {}\n                this.Save();\n            } else {\n                this._dLocalData = data;\n            }\n        }\n    }\n\n    /**\n     * protected 只让实现类操作数据  也就是model类型操作数据 对外提供别的方法\n     * @param sKey \n     * @param defaultValue \n     */\n    public Query(sKey: string, defaultValue: any = null) {\n        if (this._dLocalData[sKey] != undefined) {\n            return this._dLocalData[sKey];\n        }\n        return defaultValue;\n    }\n\n    /**\n     * 设置成功返回 true，反之返回 false 用于是否保存数据\n     * @param sKey \n     * @param value\n     */\n    public Set(sKey: string, value: string | number | boolean) {\n        if (this._dLocalData[sKey] && this._dLocalData[sKey] == value) {\n            return false;//一样就不要改了\n        }\n        this._dLocalData[sKey] = value;\n        return true;\n    }\n\n    public Save() {\n        if(cc.sys.platform == cc.sys.WECHAT_GAME){\n            wx.setStorage({\n                key: `model_${this.modelName}`,\n                data: JSON.stringify(this._dLocalData)\n              })\n        }else{\n            cc.sys.localStorage.setItem(`model_${this.modelName}`, JSON.stringify(this._dLocalData));\n        }\n    }\n}\n"]}