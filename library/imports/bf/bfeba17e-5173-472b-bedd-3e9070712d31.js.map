{"version":3,"sources":["assets/script/logic/ui/scene/UIGame.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import GameController from \"../../../GameController\";\nimport auto_game from \"../../../data/autoui/scene/auto_game\";\nimport { AudioMng } from \"../../../framework/manager/AudioMng\";\nimport UIBase from \"../../../framework/ui/UIBase\";\nimport UIHelp from \"../../../framework/ui/UIHelp\";\nimport { ConfigModule } from \"../../../userData/ConfigModule\";\nimport GameDataCenter from \"../../../userData/GameDataCenter\";\nimport { Utils } from \"../../../utils/Utils\";\nimport UIGameLayer from \"../prefab/UIGameLayer\";\n\nconst { ccclass, menu, property } = cc._decorator;\n\n@ccclass\n@menu(\"UI/scene/UIGame\")\nexport default class UIGame extends UIBase {\n\tui: auto_game = null;\n\n\tprotected static prefabUrl = \"\";\n\tprotected static className = \"UIGame\";\n\n\tpublic static instance: UIGame = null;\n\n\t@property({ type: [cc.Sprite] })\n\ticonsSpr: cc.Sprite[] = [];\n\n\t@property({ type: [cc.Label] })\n\tcurrencysName: cc.Label[] = [];\n\tonUILoad() {\n\t\tthis.ui = this.node.addComponent(auto_game);\n\t\tUIGame.instance = this;\n\t\tGameController.init();\n\t\t(window as any).GetGameInfo()\n\t\t.then(res => {\n\t\t\tconsole.log(res, '获取游戏信息成功')\n\t\t\tif (res.code == 0) {\n\t\t\t\t(window as any).currencyIcon = res.data.icon;\n\t\t\t\t(window as any).currencyName = res.data.coin;\n\n\t\t\t\tcc.assetManager.loadRemote((window as any).currencyIcon, (err, texture) => {\n\t\t\t\t\tif (err) {\n\t\t\t\t\t\tconsole.log(err)\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconsole.log(texture, 'texture')\n\t\t\t\t\tconst spriteFrame = new cc.SpriteFrame(texture as cc.Texture2D);\n\t\t\t\t\tspriteFrame.addRef();\n\t\t\t\t\tthis.iconsSpr.forEach(item => {\n\t\t\t\t\t\titem.spriteFrame = spriteFrame;\n\t\t\t\t\t})\n\t\t\t\t});\n\t\t\t\tthis.currencysName.forEach(item => {\n\t\t\t\t\titem.string = (window as any).currencyName;\n\t\t\t\t})\n\t\t\t}\n\n\t\t})\n\t\t.catch(err => {\n\t\t\tconsole.log(err, '获取游戏信息失败')\n\t\t})\n\t}\n\n\tonShow() {\n\t}\n\n\tonHide() {\n\n\t}\n\n\tasync onStart() {\n\t\tAudioMng.getInstance().initBgm()\n\t\ttry {\n\t\t\tawait GameDataCenter.accountModel.login(Utils.getQueryString(\"token\") || 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpZCI6IjI0NTkzNSIsImV4cCI6MTc5MzUzODY3OSwiYWNjb3VudCI6IlRQSHlYY2hkcVFaaHhYSlVSZXk2d0J5UUdKd282RWVpMlgifQ.wGadx9NSFnQ7beVEYK3Za-oBV5tEbCy6pdXVTSrNdQM', Utils.getQueryString(\"company-code\") || 'null');\n\t\t\twindow.history.pushState({}, 'Treasure Guard', '/');\n\t\t\t//await GameDataCenter.accountModel.login(Utils.getQueryString(\"token\"));\n\t\t\tGameController.socket.connect();\n\t\t} catch (error) {\n\n\t\t}\n\n\t}\n\n\tshowStage3Ani() {\n\t\tthis.playShashouChuxian();\n\t}\n\tshowStage5Ani() {\n\t\tUIGameLayer.instance.openAllDoors();\n\t\tthis.ui.stage_5.active = true;\n\t\tthis.ui.VM_result.active = true;\n\t\tvar resultType = GameDataCenter.roomInfoModel.resultType;\n\t\t// if(resultType == 3 || resultType == 4){\n\t\t// \tthis.ui.caidai.active = true;\n\t\t// \tthis.ui.caidai.getComponent(sp.Skeleton).setAnimation(0, \"animation\", false);\n\t\t// \tthis.ui.caidai.getComponent(sp.Skeleton).setCompleteListener(()=>{\n\t\t// \t\tthis.ui.caidai.active = false;\n\t\t// \t})\n\t\t// }\n\t\tthis.scheduleOnce(() => {\n\t\t\tthis.ui.VM_result.active = false;\n\t\t\tthis.ui.stage_5.active = false;\n\t\t}, 5);\n\t}\n\n\tplayShashouChuxian() {\n\t\tthis.ui.stage_3.getComponent(cc.Animation).play();\n\t}\n\n\tonClose() {\n\t\tUIHelp.CloseUI(UIGame);\n\t}\n}"]}