{"version":3,"sources":["assets/script/framework/component/VMEvent.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import VMBase from './VMBase';\n\n//todo\n\n// +普通 label 更新数据的情况,label.string = xxx;\n// +frameIndex 插件，通过number 数值设置 BhvFrameIndex 来切换当前贴图\n// +spriteFrame 直接替换贴图的情况 , \n//  读取本地路径 data.spriteFrame = $res:/pic/com1\n//  读取网页路径 data.spriteFrame = $url:http:xxxxxxxxxx.png\n// +特殊条件控制 \n\n// 比较条件:,如果传入值 > /< />= /<= /== 某值时，执行的action类型\n\nconst {ccclass, property,executeInEditMode,menu,help} = cc._decorator;\n\n// enum WatchMode {\n//     ccLabel,\n//     ccRichText,\n//     ccSlider,\n//     ccProgressBar,\n// }\n\nenum FILTER_MODE {\n    \"none\",\n    \"==\", //正常计算，比较 等于\n    \"!=\", //正常计算，比较 不等于\n    \">\",  //正常计算，比较>\n    \">=\", //正常计算，比较>=\n    \"<\",  //正常计算，比较<\n    \"<=\", // 正常计算，比较>=\n}\n\n/**\n *  [VM-Event]\n * 提供  ViewModel 的相关基础功能,\n * 如果值发生变化将会调用对应的函数方法\n */\n@ccclass\n@executeInEditMode\n@menu('ModelViewer/VM-EventCall(调用函数)')\n@help('https://github.com/wsssheep/cocos_creator_mvvm_tools/blob/master/docs/VMEvent.md')\nexport default class VMEvent extends VMBase {\n    \n    @property({\n        tooltip: '使用模板模式，可以使用多路径监听'\n    })\n    public templateMode: boolean = false;\n \n    @property({\n        tooltip:'监听获取值的路径',\n        visible:function(){return this.templateMode === false }\n    })\n    watchPath:string = \"\";\n\n    @property({\n        tooltip:'触发一次后会自动关闭该事件'\n    })\n    triggerOnce:boolean = false;\n\n    @property({\n        tooltip:'监听获取值的多条路径,这些值的改变都会通过这个函数回调,请使用 pathArr 区分获取的值 ',\n        type: [cc.String],\n        visible: function () { return this.templateMode === true }\n    })\n    protected watchPathArr: string[] = [];\n\n    @property({\n        tooltip: '过滤模式，会根据条件过滤掉时间的触发',\n        type:cc.Enum(FILTER_MODE)\n    })\n    public filterMode:FILTER_MODE = FILTER_MODE.none;\n\n    @property({\n        visible:function(){return this.filterMode !== FILTER_MODE.none}\n    })\n    public compareValue:string = '';\n\n\n    @property([cc.Component.EventHandler])\n    changeEvents:cc.Component.EventHandler[] = [];\n\n\n    // LIFE-CYCLE CALLBACKS:\n\n    // onLoad () {}\n\n    onValueInit(){\n        \n    }\n    \n    onValueChanged(newVar:any,oldVar:any,pathArr:any[]){\n        let res =  this.conditionCheck(newVar,this.compareValue);\n        if(!res)return;\n        \n        if(Array.isArray(this.changeEvents)){\n            this.changeEvents.forEach(v=>{\n                v.emit([newVar,oldVar,pathArr]);\n            })\n        }\n\n        //激活一次后，自动关闭组件\n        if(this.triggerOnce === true){\n            this.enabled = false;\n        }\n    }\n\n\n      /**条件检查 */\n      private conditionCheck(a,b):boolean{\n        let cod = FILTER_MODE;\n\n        switch (this.filterMode) {\n            case cod.none:\n                return true;\n            case cod[\"==\"]:\n                if(a == b)return true;\n                break;\n            case cod[\"!=\"]:\n                if(a != b)return true;\n                break;\n            case cod[\"<\"]:\n                if(a < b)return true;\n                break;\n            case cod[\">\"]:\n                if(a > b)return true;\n                break;\n            case cod[\">=\"]:\n                if(a >= b)return true;\n                break;\n            case cod[\"<\"]:\n                if(a < b)return true;\n                break;\n            case cod[\"<=\"]:\n                if(a <= b)return true;\n                break;\n        \n            default:\n                break;\n        }\n\n        return false;\n    }\n\n    // update (dt) {}\n}\n\n"]}